{"ast":null,"code":"// a simple parser for Valve's KeyValue format\n// https://developer.valvesoftware.com/wiki/KeyValues\n//\n// author: Rossen Popov, 2014-2016\nfunction parse(text) {\n  if (typeof text != \"string\") {\n    throw new TypeError(\"VDF.parse: Expecting parameter to be a string\");\n  }\n\n  lines = text.split(\"\\n\");\n  var obj = {};\n  var stack = [obj];\n  var expect_bracket = false;\n  var name = \"\";\n  var re_kv = new RegExp('^(\"((?:\\\\\\\\.|[^\\\\\\\\\"])+)\"|([a-z0-9\\\\-\\\\_]+))' + '([ \\t]*(' + '\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)(\")?' + '|([a-z0-9\\\\-\\\\_]+)' + '))?');\n  var i = 0,\n      j = lines.length;\n\n  for (; i < j; i++) {\n    line = lines[i].trim(); // skip empty and comment lines\n\n    if (line == \"\" || line[0] == '/') {\n      continue;\n    } // one level deeper\n\n\n    if (line[0] == \"{\") {\n      expect_bracket = false;\n      continue;\n    }\n\n    if (expect_bracket) {\n      throw new SyntaxError(\"VDF.parse: invalid syntax on line \" + (i + 1));\n    } // one level back\n\n\n    if (line[0] == \"}\") {\n      stack.pop();\n      continue;\n    } // parse keyvalue pairs\n\n\n    while (true) {\n      m = re_kv.exec(line);\n\n      if (m === null) {\n        throw new SyntaxError(\"VDF.parse: invalid syntax on line \" + (i + 1));\n      } // qkey = 2\n      // key = 3\n      // qval = 6\n      // vq_end = 7\n      // val = 8\n\n\n      var key = m[2] !== undefined ? m[2] : m[3];\n      var val = m[6] !== undefined ? m[6] : m[8];\n\n      if (val === undefined) {\n        // chain (merge) duplicate key\n        if (stack[stack.length - 1][key] === undefined || typeof stack[stack.length - 1][key] !== 'object') {\n          stack[stack.length - 1][key] = {};\n        }\n\n        stack.push(stack[stack.length - 1][key]);\n        expect_bracket = true;\n      } else {\n        if (m[7] === undefined && m[8] === undefined) {\n          line += \"\\n\" + lines[++i];\n          continue;\n        }\n\n        stack[stack.length - 1][key] = val;\n      }\n\n      break;\n    }\n  }\n\n  if (stack.length != 1) throw new SyntaxError(\"VDF.parse: open parentheses somewhere\");\n  return obj;\n}\n\nfunction stringify(obj, pretty) {\n  if (typeof obj != \"object\") {\n    throw new TypeError(\"VDF.stringify: First input parameter is not an object\");\n  }\n\n  pretty = typeof pretty == \"boolean\" && pretty ? true : false;\n  return _dump(obj, pretty, 0);\n}\n\nfunction _dump(obj, pretty, level) {\n  if (typeof obj != \"object\") {\n    throw new TypeError(\"VDF.stringify: a key has value of type other than string or object\");\n  }\n\n  var indent = \"\\t\";\n  var buf = \"\";\n  var line_indent = \"\";\n\n  if (pretty) {\n    for (var i = 0; i < level; i++) {\n      line_indent += indent;\n    }\n  }\n\n  for (key in obj) {\n    if (typeof obj[key] == \"object\") {\n      buf += [line_indent, '\"', key, '\"\\n', line_indent, '{\\n', _dump(obj[key], pretty, level + 1), line_indent, \"}\\n\"].join('');\n    } else {\n      buf += [line_indent, '\"', key, '\" \"', String(obj[key]), '\"\\n'].join('');\n    }\n  }\n\n  return buf;\n}\n\nexports.parse = parse;\nexports.stringify = stringify;\nexports.dump = stringify;","map":{"version":3,"names":["parse","text","TypeError","lines","split","obj","stack","expect_bracket","name","re_kv","RegExp","i","j","length","line","trim","SyntaxError","pop","m","exec","key","undefined","val","push","stringify","pretty","_dump","level","indent","buf","line_indent","join","String","exports","dump"],"sources":["/home/daniil/github/steamApp/node_modules/simple-vdf/index.js"],"sourcesContent":["// a simple parser for Valve's KeyValue format\n// https://developer.valvesoftware.com/wiki/KeyValues\n//\n// author: Rossen Popov, 2014-2016\n\nfunction parse(text) {\n    if(typeof text != \"string\") {\n        throw new TypeError(\"VDF.parse: Expecting parameter to be a string\");\n    }\n\n    lines = text.split(\"\\n\");\n\n    var obj = {};\n    var stack = [obj];\n    var expect_bracket = false;\n    var name = \"\";\n\n    var re_kv = new RegExp(\n        '^(\"((?:\\\\\\\\.|[^\\\\\\\\\"])+)\"|([a-z0-9\\\\-\\\\_]+))' +\n        '([ \\t]*(' +\n        '\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)(\")?' +\n        '|([a-z0-9\\\\-\\\\_]+)' +\n        '))?'\n        );\n\n    var i = 0, j = lines.length;\n    for(; i < j; i++) {\n        line = lines[i].trim();\n\n        // skip empty and comment lines\n        if( line == \"\" || line[0] == '/') { continue; }\n\n        // one level deeper\n        if( line[0] == \"{\" ) {\n            expect_bracket = false;\n            continue;\n        }\n\n        if(expect_bracket) {\n            throw new SyntaxError(\"VDF.parse: invalid syntax on line \" + (i+1));\n        }\n\n        // one level back\n        if( line[0] == \"}\" ) {\n            stack.pop();\n            continue;\n        }\n\n        // parse keyvalue pairs\n        while(true) {\n            m = re_kv.exec(line);\n\n            if(m === null) {\n                throw new SyntaxError(\"VDF.parse: invalid syntax on line \" + (i+1));\n            }\n\n            // qkey = 2\n            // key = 3\n            // qval = 6\n            // vq_end = 7\n            // val = 8\n            var key = (m[2] !== undefined) ? m[2] : m[3];\n            var val = (m[6] !== undefined) ? m[6] : m[8];\n\n            if(val === undefined) {\n                // chain (merge) duplicate key\n                if(stack[stack.length-1][key] === undefined || typeof stack[stack.length-1][key] !== 'object') {\n                    stack[stack.length-1][key] = {};\n                }\n\n\n                stack.push(stack[stack.length-1][key]);\n                expect_bracket = true;\n            }\n            else {\n                if(m[7] === undefined && m[8] === undefined) {\n                    line += \"\\n\" + lines[++i];\n                    continue;\n                }\n\n                stack[stack.length-1][key] = val;\n            }\n\n            break;\n        }\n    }\n\n    if(stack.length != 1) throw new SyntaxError(\"VDF.parse: open parentheses somewhere\");\n\n    return obj;\n}\n\nfunction stringify(obj,pretty) {\n    if( typeof obj != \"object\") {\n            throw new TypeError(\"VDF.stringify: First input parameter is not an object\");\n    }\n\n    pretty = ( typeof pretty == \"boolean\" && pretty) ? true : false;\n\n    return _dump(obj,pretty,0);\n}\n\nfunction _dump(obj,pretty,level) {\n    if( typeof obj != \"object\" ) {\n        throw new TypeError(\"VDF.stringify: a key has value of type other than string or object\");\n    }\n\n    var indent = \"\\t\";\n    var buf = \"\";\n    var line_indent = \"\";\n\n\n    if(pretty) {\n        for(var i = 0; i < level; i++ ) {\n            line_indent += indent;\n        }\n    }\n\n    for(key in obj) {\n        if( typeof obj[key] == \"object\" ) {\n            buf += [line_indent, '\"', key, '\"\\n', line_indent, '{\\n', _dump(obj[key],pretty,level+1), line_indent, \"}\\n\"].join('');\n        }\n        else {\n            buf += [line_indent, '\"', key, '\" \"', String(obj[key]), '\"\\n'].join('');\n        }\n    }\n\n    return buf;\n}\n\nexports.parse = parse;\nexports.stringify = stringify;\nexports.dump = stringify;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}